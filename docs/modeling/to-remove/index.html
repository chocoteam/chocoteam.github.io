<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.63.2" />

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">



<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Choco-solver</title><meta property="og:title" content="" />
<meta property="og:description" content="Modeling The Model The object Model is the key component. It is built as follows:
Model model = new Model(); or:
Model model = new Model(&quot;my problem&quot;); This should be the first instruction, prior to any other modeling instructions, as it is needed to declare variables and constraints.
Variables Principle A variable is an unknown, mathematically speaking. The goal of a resolution is to assign a value to each variable. The domain of a variable –(super)set of values it may take– must be defined in the model." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/docs/modeling/to-remove/" />
<meta property="og:site_name" content="Choco-solver" />
<meta itemprop="name" content="">
<meta itemprop="description" content="Modeling The Model The object Model is the key component. It is built as follows:
Model model = new Model(); or:
Model model = new Model(&quot;my problem&quot;); This should be the first instruction, prior to any other modeling instructions, as it is needed to declare variables and constraints.
Variables Principle A variable is an unknown, mathematically speaking. The goal of a resolution is to assign a value to each variable. The domain of a variable –(super)set of values it may take– must be defined in the model.">

<meta itemprop="wordCount" content="2837">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="Modeling The Model The object Model is the key component. It is built as follows:
Model model = new Model(); or:
Model model = new Model(&quot;my problem&quot;); This should be the first instruction, prior to any other modeling instructions, as it is needed to declare variables and constraints.
Variables Principle A variable is an unknown, mathematically speaking. The goal of a resolution is to assign a value to each variable. The domain of a variable –(super)set of values it may take– must be defined in the model."/>





<link rel="preload" href="/scss/main.min.78e92ed9d1b57ba18ddc7b73b175490ef462f35b99bef934d9027442e2a9f328.css" as="style">
<link href="/scss/main.min.78e92ed9d1b57ba18ddc7b73b175490ef462f35b99bef934d9027442e2a9f328.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>



    <title>Choco-solver</title>
  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" id="Layer_1" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500" sodipodi:docname="logo.svg" inkscape:version="0.92.2 5c3e80d, 2017-08-06"><defs id="defs953" /><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1432" inkscape:window-height="773" id="namedview951" showgrid="false" inkscape:zoom=".472" inkscape:cx="365.4661" inkscape:cy="250" inkscape:window-x="10" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="Layer_1" /><path inkscape:export-ydpi="300" inkscape:export-xdpi="300" style="fill:#005c94;stroke:none;stroke-width:4.78758144" inkscape:connector-curvature="0" id="path2" d="m279.38249 191.64706c-5.13397-7.99619-.49997-20.9386 10.34205-28.91 10.85587-7.96647 23.80888-7.93677 28.9475.0694 5.13861 8.00113.51387 20.94354-10.34204 28.91-10.84664 7.96153-23.80888 7.93677-28.94751-.0693m60.91337 161.55234c0-12.74437-9.30965-14.87832-14.2955-14.87832-12.6984.0-13.55482 16.74491-4.60161 16.74491 6.23113.0 10.59666-3.74803 8.49491-9.47655 5.29602 4.64917 4.26828 16.56173-9.97633 15.97253-16.36486-.6585-15.48525-28.22675 4.79606-28.90507 13.81869-.46043 25.04031 7.15946 25.04031 20.55241.0 21.71095-28.71142 34.40086-53.97393 20.54744 18.13327 8.31306 44.51609-1.69825 44.51609-20.55735M221.0801 379.08926c0 13.5712-10.11059 21.01777-22.41548 21.01777-12.30951.0-25.76712-10.28855-19.61467-28.38517-3.67111 16.48252 10.13369 21.66147 17.82773 21.66147 9.97168.0 16.01302-7.26339 16.01302-15.08134.0-7.81298-4.00905-10.17964-8.36528-10.17964-6.38856.0-10.65222 7.03565-6.62927 9.76869-7.69403.0-3.42575-13.84351 6.92091-14.80406 8.84674-.82683 16.26304 4.89673 16.26304 16.00228m85.79166-143.69352c18.4851-7.50106 32.30379.3763 84.74543-17.03706 47.49743-15.77447 108.81357-81.14008 61.79759-126.750421-38.48404-37.341884-116.35484-26.632444-159.8988 4.34219-16.02692 11.392671-27.95683 26.478951-37.63685 41.466211 2.65265.47035 4.99511 1.63883 6.66632 3.70349 5.09693 6.29791 2.29616 17.81931-6.24504 25.71648-6.91631 6.39694-15.43437 8.37741-21.15164 5.58988-16.39264 25.10252-37.26652 35.67333-52.68697 39.45108 14.79549-6.71383 31.7066-22.71109 38.97473-38.2628-41.96531 16.29436-55.72848-24.45391-24.70238-30.65281-14.95288 4.21841-14.03163 25.01342 5.66637 25.01342 22.63767.0 27.83648-41.25333-5.66637-41.25333-19.37394.0-31.15569 10.08064-39.2664 22.95868 36.78045 25.52832 18.36478 60.33025-6.76814 60.33025-45.02073.0-20.5915-56.74064.69903-35.08909-17.79534-11.94723-28.96602 24.63712-.3472 24.63712 22.68396.0 24.4524-31.08852 1.56937-41.81278-18.32309-8.58043-42.75233-6.71383-57.066373 11.94719-13.47148 17.57673-10.85126 38.37173 7.226453 51.02203 22.10531 15.46752 11.76791 39.6838-.18056 47.45716-13.735373 8.93195-31.164973 4.31744-31.164973-7.43669.0-4.10949 2.7915-10.8233 8.02272-10.8233-5.75896 1.48535-6.61077 14.13565 5.86078 14.13565 8.19865.0 18.249033-4.26794 18.249033-16.67562.0-8.22886-4.370153-20.94849-27.378163-20.94849-22.60064.0-46.46509 19.75526-46.46509 49.79908.0 30.04875 26.86892 41.89696 58.63572 38.35686 25.128263-2.79742 36.090663-21.45845 59.681963-7.83773 26.17915 15.12093 21.0498 49.4277 12.82803 67.46984-10.2078 22.39423-5.61081 61.50368 36.91004 57.67145 34.71572-3.11926 41.79867-28.79612 40.83113-45.63016-1.05088-18.47784-10.81887-27.34543-22.68396-31.44995 17.45274-5.22846 38.18313 3.75795 47.81684 27.62268 6.63393 16.42806 22.33677 29.86063 47.46969 29.86063 38.39143.0 58.55704-24.81536 55.83957-55.24537-1.05086-11.75908-8.0227-29.11795-24.4246-31.72722 9.07359-12.31853 23.38301-17.17565 53.04807-10.45195 25.79027 5.83744 48.16868-15.30413 48.16868-35.46537.0-33.96516-28.97066-40.31753-41.53015-40.31753-14.66588.0-28.42903 8.19916-28.42903 23.1369.0 12.68991 9.39302 17.93322 20.04521 17.93322 12.22158.0 19.80451-4.87693 19.80451-12.90777.0-13.06618-17.71201-15.49723-24.01262-7.03562 5.90711-13.77421 30.73446-9.61523 30.73446 8.74873.0 10.05093-6.99036 19.40371-27.57259 19.40371-24.5033.0-36.6508-23.51815-28.62808-41.06514-6.97186 1.86658-13.95296 7.47132-21.05905 10.58564-40.8589 17.9035-51.60833-16.28942-36.32674-22.48337" /></svg></span><span class="text-uppercase font-weight-bold">Choco-solver</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link active" href="/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/tutos/" ><span>Tutorials</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/blog/" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/community/" ><span>Community</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="off">

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    
<input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="off">


    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a>
  </li>
  <ul>
    <li class="collapse show" id="docs">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting-started/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Getting Started</a>
  </li>
  <ul>
    <li class="collapse " id="docsgetting-started">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/modeling/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Modeling</a>
  </li>
  <ul>
    <li class="collapse show" id="docsmodeling">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsmodelingvariables" href="/docs/modeling/variables/">Declaring variables</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsmodelingconstraints" href="/docs/modeling/constraints/">Handling constraints</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsmodelingintconstraints" href="/docs/modeling/intconstraints/">Constraints over integer variables</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsmodelingsetconstraints" href="/docs/modeling/setconstraints/">Constraints over set variables</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsmodelingrealconstraints" href="/docs/modeling/realconstraints/">Constraints over real variables</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsmodelingexpressions" href="/docs/modeling/expressions/">Building expressions</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page  active" id="m-docsmodelingto-remove" href="/docs/modeling/to-remove/"></a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/solving/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Solving</a>
  </li>
  <ul>
    <li class="collapse " id="docssolving">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docssolvingstrategies" href="/docs/solving/strategies/">Exploring search space</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docssolvingsolving" href="/docs/solving/solving/">Looking for solutions</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docssolvingto-remove" href="/docs/solving/to-remove/"></a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/parsing/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Parsing</a>
  </li>
  <ul>
    <li class="collapse " id="docsparsing">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/advanced-usages/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Advanced usages</a>
  </li>
  <ul>
    <li class="collapse " id="docsadvanced-usages">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsadvanced-usagespropagator" href="/docs/advanced-usages/propagator/">Designing a propagator</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsadvanced-usagesto-remove" href="/docs/advanced-usages/to-remove/"></a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            






<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">





<a href="https://github.com/chocoteam/choco-solver/edit/master/site/content/en/docs/Modeling/to-remove.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/chocoteam/choco-solver/issues/new?title=" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>


<a href="https://github.com/chocoteam/choco-solver/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>

</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#the-model">The Model</a></li>
    <li><a href="#variables">Variables</a>
      <ul>
        <li><a href="#principle">Principle</a></li>
        <li><a href="#integer-variables">Integer variables</a></li>
        <li><a href="#boolean-variable">Boolean variable</a></li>
        <li><a href="#set-variables">Set variables</a></li>
        <li><a href="#real-variables">Real variables</a></li>
        <li><a href="#views-creating-variables-from-constraints">Views: Creating variables from constraints</a></li>
      </ul>
    </li>
    <li><a href="#constraints">Constraints</a>
      <ul>
        <li><a href="#constraints-and-propagators">Constraints and propagators</a></li>
        <li><a href="#list-of-available-constraints">List of available constraints</a></li>
        <li><a href="#posting-constraints">Posting constraints</a></li>
        <li><a href="#reifying-constraints">Reifying constraints</a></li>
        <li><a href="#some-specific-constraints">Some specific constraints</a></li>
        <li><a href="#designing-your-own-constraint">Designing your own constraint</a></li>
        <li><a href="#idempotency">Idempotency</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="/docs/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="/docs/modeling/">Modeling</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/docs/modeling/to-remove/"></a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1></h1>
	
	<h1 id="modeling">Modeling</h1>
<h2 id="the-model">The Model</h2>
<p>The object <code>Model</code> is the key component. It is built as follows:</p>
<pre><code>Model model = new Model();
</code></pre><p>or:</p>
<pre><code>Model model = new Model(&quot;my problem&quot;);
</code></pre><p>This should be the first instruction, prior to any other modeling instructions, as it is needed to declare variables and constraints.</p>
<h2 id="variables">Variables</h2>
<h3 id="principle">Principle</h3>
<p>A variable is an <em>unknown</em>, mathematically speaking.
The goal of a resolution is to <em>assign</em> a <em>value</em> to each variable.
The <em>domain</em> of a variable –(super)set of values it may take– must be defined in the model.</p>
<p>Choco 4 includes several types of variables: <code>BoolVar</code>, <code>IntVar</code>, <code>SetVar</code> and <code>RealVar</code>.
Variables are created using the <code>Model</code> object.
When creating a variable, the user can specify a name to help reading the output.</p>
<h3 id="integer-variables">Integer variables</h3>
<p>An integer variable an unknown whose value should be an integer. Therefore, the domain of an integer variable is a set of integers (representing possible values).
To create an integer variable, the <code>Model</code> should be used:</p>
<pre><code>// Create a constant variable equal to 42
IntVar v0 = model.intVar(&quot;v0&quot;, 42);
// Create a variable taking its value in [1, 3] (the value is 1, 2 or 3)
IntVar v1 = model.intVar(&quot;v1&quot;, 1, 3);
// Create a variable taking its value in {1, 3} (the value is 1 or 3)
IntVar v2 = model.intVar(&quot;v2&quot;, new int[]{1, 3});
</code></pre><p>It is then possible to build directly arrays and matrices of variables having the same initial domain with:</p>
<pre><code>// Create an array of 5 variables taking their value in [-1, 1]
IntVar[] vs = model.intVarArray(&quot;vs&quot;, 5, -1, 1);
// Create a matrix of 5x6 variables taking their value in [-1, 1]
IntVar[][] vs = model.intVarMatrix(&quot;vs&quot;, 5, 6, -1, 1);
</code></pre><p>There exists different ways to encode the domain of an integer variable.</p>
<h4 id="bounded-domain">Bounded domain</h4>
<p>When the domain of an integer variable is said to be <em>bounded</em>, it is represented through
an interval of the form $[![a,b]!]$ where $a$ and $b$ are integers such that $a &lt;= b$.
This representation is pretty light in memory (it requires only two integers) but it cannot represent <em>holes</em> in the domain.
For instance, if we have a variable whose domain is $[![0,10]!]$ and a constraint enables to detect that
values 2, 3, 7 and 8 are infeasible, then this learning will be lost as it cannot be encoded in the domain (which remains the same).</p>
<p>To specify you want to use bounded domains, set the <code>boundedDomain</code> argument to <code>true</code> when creating variables:</p>
<pre><code>IntVar v = model.intVar(&quot;v&quot;, 1, 12, true);
</code></pre><p><strong>NOTE</strong>: When using bounded domains, branching decisions must either be domain splits or bound assignments/removals.
Indeed, assigning a bounded variable to a value strictly comprised between its bounds may results in infinite loop
because such branching decisions will not be refutable.</p>
<h4 id="enumerated-domains">Enumerated domains</h4>
<p>When the domain of an integer variable is said to be <em>enumerated</em>, it is represented through
the set of possible values, in the form:</p>
<ul>
<li>$[![a,b]!]$ where $a$ and $b$ are integers such that $a &lt;= b$</li>
<li>{$a,b,c,..,z$}, where $a &lt; b &lt; c &hellip; &lt; z$.
Enumerated domains provide more information than bounded domains but are heavier in memory (the domain usually requires a bitset).</li>
</ul>
<p>To specify you want to use enumerated domains, either set the <code>boundedDomain</code> argument to <code>false</code> when creating variables by specifying two bounds
or use the signature that specifies the array of possible values:</p>
<pre><code>IntVar v = model.intVar(&quot;v&quot;, 1, 4, false);
IntVar v = model.intVar(&quot;v&quot;, new int[]{1,2,3,4});
</code></pre><h3 id="boolean-variable">Boolean variable</h3>
<p>Boolean variables, <code>BoolVar</code>, are specific <code>IntVar</code> that take their value in $[![0,1]!]$.
The avantage of <code>BoolVar</code> is twofold:</p>
<ul>
<li>They can be used to say whether or not constraint should be satisfied (reification)</li>
<li>Their domain, and some filtering algorithms, are optimized</li>
</ul>
<p>To create a new boolean variable:</p>
<pre><code>BoolVar b = model.boolVar(&quot;b&quot;);
</code></pre><h3 id="set-variables">Set variables</h3>
<p>A set variable, <code>SetVar</code>, represents a set of integers, i.e. its value is a set of integers.
Its domain is defined by a set interval <code>[LB,UB]</code> where:</p>
<ul>
<li>
<p>the lower bound, <code>LB</code>, is an <code>ISet</code> object which contains integers that figure in every solution.</p>
</li>
<li>
<p>the upper bound, <code>UB</code>, is an <code>ISet</code> object which contains integers that potentially figure in at least one solution,</p>
</li>
</ul>
<p>Initial values for both <code>LB</code> and <code>UB</code> should be such that <code>LB</code> is a subset of <code>UB</code>.
Then, decisions and filtering algorithms will remove integers from <code>UB</code> and add some others to <code>LB</code>.
A set variable is instantiated if and only if <code>LB = UB</code>.</p>
<p>A set variable can be created as follows:</p>
<pre><code>// Constant SetVar equal to {2,3,12}
SetVar x = model.setVar(&quot;x&quot;, new int[]{2,3,12});

// SetVar representing a subset of {1,2,3,5,12}
SetVar y = model.setVar(&quot;y&quot;, new int[]{}, new int[]{1,2,3,5,12});
// possible values: {}, {2}, {1,3,5} ...

// SetVar representing a superset of {2,3} and a subset of {1,2,3,5,12}
SetVar z = model.setVar(&quot;z&quot;, new int[]{2,3}, new int[]{1,2,3,5,12});
// possible values: {2,3}, {2,3,5}, {1,2,3,5} ...
</code></pre><h3 id="real-variables">Real variables</h3>
<p>The domain of a real variable is an interval of doubles. Conceptually, the value of a real variable is a double.
However, it uses a precision parameter for floating number computation,
so its actual value is generally an interval of doubles, whose size is constrained by the precision parameter.
Real variables have a specific status in Choco 4, which uses <a href="http://www.ibex-lib.org/">Ibex solver</a> to define constraints.</p>
<p>A real variable is declared with three doubles defining its bound and a precision:</p>
<pre><code>RealVar x = model.realVar(&quot;x&quot;, 0.2d, 3.4d, 0.001d);
</code></pre><h3 id="views-creating-variables-from-constraints">Views: Creating variables from constraints</h3>
<p>When a variable is defined as a function of another variable, views can be
used to make the model shorter. In some cases, the view has a specific (optimized) domain representation.
Otherwise, it is simply a modeling shortcut to create a variable and post a constraint at the same time.
Few examples:</p>
<p><code>x = y + 2</code> :</p>
<pre><code>IntVar x = model.intOffsetView(y, 2);
</code></pre><p><code>x = -y</code> :</p>
<pre><code>IntVar x = model.intMinusView(y);
</code></pre><p><code>x = 3\*y</code> :</p>
<pre><code>IntVar x = model.intScaleView(y, 3);
</code></pre><p>Views can be combined together, e.g. <code>x = 2\*y + 5</code> is:</p>
<pre><code>IntVar x = model.intOffsetView(model.intScaleView(y,2),5);
</code></pre><p>We can also use a view mecanism to link an integer variable with a real variable.</p>
<pre><code>IntVar ivar = model.intVar(&quot;i&quot;, 0, 4);
double precision = 0.001d;
RealVar rvar = model.realIntView(ivar, precision);
</code></pre><p>This code enables to embed an integer variable in a constraint that is defined over real variables.</p>
<h2 id="constraints">Constraints</h2>
<h3 id="constraints-and-propagators">Constraints and propagators</h3>
<h4 id="main-principles">Main principles</h4>
<p>A constraint is a logic formula defining allowed combinations of values for a set of variables,
i.e., restrictions over variables that must be respected in order to get a feasible solution.
A constraint is equipped with a (set of) filtering algorithm(s), named <em>propagator(s)</em>.
A propagator <strong>removes</strong>, from the domains of the target variables, values that cannot correspond to a valid combination of values.
A solution of a problem is variable-value assignment verifying all the constraints.</p>
<p>Constraint can be declared in <em>extension</em>, by defining the valid/invalid tuples, or in <em>intension</em>, by defining a relation between the variables.
For a given requirement, there can be several constraints/propagators available.
A widely used example is the AllDifferent constraint which ensures that all its variables take a distinct value in a solution.
Such a rule can be formulated using :</p>
<ul>
<li>
<p>a clique of basic inequality constraints,</p>
</li>
<li>
<p>a generic table constraint (an extension constraint that lists the valid tuples),</p>
</li>
<li>
<p>a dedicated global constraint analysing :</p>
<ul>
<li>
<p>instantiated variables (<em>Forward checking propagator</em>),</p>
</li>
<li>
<p>variable domain bounds (<em>Bound consistency propagator</em>),</p>
</li>
<li>
<p>variable domains (<em>Arc consistency propagator</em>).</p>
</li>
</ul>
</li>
</ul>
<p>Depending on the problem to solve, the efficiency of each option may be dramatically different.
In general, we tend to use global constraints, that capture a good part of the problem structure.
However, these constraints often model problems that are inherently NP-complete so only a partial filtering is performed
in general, to keep polynomial time algorithms.
This is for example the case of NValue constraint that one aspect relates to the problem of “minimum hitting set.”</p>
<h4 id="design-choices">Design choices</h4>
<h5 id="class-organization">Class organization</h5>
<p>In Choco Solver 4, constraints are generally not associated with a specific java class.
Instead, each constraint is associated with a specific method in <code>Model</code> that will build
a generic <code>Constraint</code> with the right list of propagators.
Each propagator is associated with a unique java class.</p>
<p>Note that it is not required to manipulate propagators, but only constraints.
However, one can define specific constraints by defining combinations of existing and/or its own propagators.</p>
<h5 id="solution-checking">Solution checking</h5>
<p>The satisfaction of the constraints is done on each solution by calling the <code>isSatisfied()</code> method of every constraint.
By default, this method checks the <code>isEntailed()</code> method of each of its propagators.</p>
<p><strong>NOTE</strong>: Additional checks (Java assertions) can be performed by adding the <code>-ea</code> instruction in the JVM arguments.
This is useful when debugging a program.</p>
<h3 id="list-of-available-constraints">List of available constraints</h3>
<p>Please refer to the javadoc of <code>Model</code> to have the list of available constraints.</p>
<h3 id="posting-constraints">Posting constraints</h3>
<p>To be effective, a constraint must be posted to the solver. This is achieved using the <code>post()</code> method:</p>
<pre><code>model.allDifferent(vars).post();
</code></pre><p>Otherwise, if the <code>post()</code> method is not called, the constraint will not be taken into account during the solution process :
it may not be satisfied in solutions.</p>
<h3 id="reifying-constraints">Reifying constraints</h3>
<p>In Choco 4, it is possible to reify any constraint. Reifying a constraint means associating it with a <code>BoolVar</code>
to represent whether or not the constraint is satisfied :</p>
<pre><code>BoolVar b = constraint.reify();
</code></pre><p>Or:</p>
<pre><code>BoolVar b = model.boolVar();
constraint.reifyWith(b);
</code></pre><p>Reifying a constraint means that we allow the constraint not to be satisfied.
Therefore, the reified constraint <strong>should not</strong> be posted.
For instance, let us consider “if <code>x&lt;0</code> then <code>y&gt;42</code>”:</p>
<pre><code>model.ifThen(
   model.arithm(x,&quot;&lt;&quot;,0),
   model.arithm(y,&quot;&gt;&quot;,42)
);
</code></pre><p><strong>NOTE</strong>: Reification is a specific process which does not rely on classical constraints.
This is why <code>ifThen</code>, <code>ifThenElse</code>, <code>ifOnlyIf</code> and <code>reification</code> return void and do not need to be posted.</p>
<p><strong>NOTE</strong>: A constraint is reified with only one boolean variable. Multiple calls to <code>constraint.reify()</code> will return the same variable.
However, the following call will associate <code>b1</code> with the constraint and then post <code>b1 = b2</code>:</p>
<pre><code>BoolVar b1 = model.boolVar();
BoolVar b2 = model.boolVar();
constraint.reifyWith(b1);
constraint.reifyWith(b2);
</code></pre><h3 id="some-specific-constraints">Some specific constraints</h3>
<h4 id="sat-constraints">SAT constraints</h4>
<p>A SAT solver is embedded in Choco. It is not  designed to be accessed directly.
The SAT solver is internally managed as a constraint (and a propagator), that’s why it is referred to as SAT constraint in the following.</p>
<p>Clauses can be added with the <code>SatFactory</code> (refer to javadoc for details).
On any call to a method of <code>SatFactory</code>, the SAT constraint (and its propagator) is created and automatically posted to the solver.
To declare complex clauses, you can call <code>SatFactory.addClauses(...)</code> by specifying a <code>LogOp</code> that represents a clause expression:</p>
<pre><code>SatFactory.addClauses(LogOp.and(LogOp.nand(LogOp.nor(a, b), LogOp.or(c, d)), e), model);
// with static import of LogOp
SatFactory.addClauses(and(nand(nor(a, b), or(c, d)), e), model);
</code></pre><h4 id="automaton-based-constraints">Automaton-based Constraints</h4>
<p><code>regular</code>, <code>costRegular</code> and <code>multiCostRegular</code> rely on an automaton, declared either implicitly or explicitly.
There are two kinds of <code>IAutomaton</code> :</p>
<ul>
<li><code>FiniteAutomaton</code>, needed for <code>regular</code>,</li>
<li><code>CostAutomaton</code>, required for <code>costRegular</code> and <code>multiCostRegular</code>.</li>
</ul>
<p><code>FiniteAutomaton</code> embeds an <code>Automaton</code> object provided by the <code>dk.brics.automaton</code> library.
Such an automaton accepts fixed-size words made of multiple <code>char</code>, but the regular constraints rely on <code>IntVar</code>,
so a mapping between <code>char</code> (needed by the underlying library) and <code>int</code> (declared in <code>IntVar</code>) has been made.
The mapping enables declaring regular expressions where a symbol is not only a digit between 0 and 9 but any <strong>positive</strong> number.
Then to distinct, in the word 101, the symbols 0, 1, 10 and 101, two additional <code>char</code> are allowed in a regexp: &lt; and &gt; which delimits numbers.</p>
<p>In summary, a valid regexp for the automaton-based constraints is a combination of <strong>digits</strong> and Java Regexp special characters.</p>
<p><code>CostAutomaton</code> is an extension of <code>FiniteAutomaton</code> where costs can be declared for each transition.</p>
<h3 id="designing-your-own-constraint">Designing your own constraint</h3>
<p>You can create your own constraint by creating a generic <code>Constraint</code> object with the appropriate propagators:</p>
<pre><code>Constraint c = new Constraint(&quot;MyConstraint&quot;, new MyPropagator(vars));
</code></pre><p>The only tricky part lies in the propagator implementation.
Your propagator must extend the <code>Propagator</code> class but not all methods have to be overwritted.
We will see two ways to implement a propagator ensuring that <code>X &gt;= Y</code>.</p>
<h4 id="basic-propagator">Basic propagator</h4>
<p>You must at least call the super constructor to specifies the scope (set of variables) of the propagator.
Then you must implement the two following methods:</p>
<p><code>void propagate(int evtmask)</code></p>
<blockquote>
<p>This method applies the global filtering algorithm of the propagator, that is, from <em>scratch</em>.
It is called once during initial propagation (to propagate initial domains) and then during the solving process if
the propagator is not incremental. It is the most important method of the propagator.</p>
</blockquote>
<p><code>isEntailed()</code></p>
<blockquote>
<p>This method checks the current state of the propagator. It is used for constraint reification.
It checks whether the propagator will be always satisfied (<code>ESat.TRUE</code>), never satisfied (<code>ESat.FALSE</code>)
or undefined (<code>ESat.UNDEFINED</code>) according to the current state of its domain variables. For instance,</p>
<ul>
<li>$A \neq B$ will always be satisfied when $A={0,1,2}$ and $B={4,5}$.</li>
<li>$A = B$ will never be satisfied when $A={0,1,2}$ and $B={4,5}$.</li>
<li>The entailment of $A \neq B$ cannot be defined when $A={0,1,2}$ and $B={1,2,3}$.</li>
</ul>
</blockquote>
<p><code>ESat isEntailed()</code> implementation may be approximate
but should at least cover the case where all variables are instantiated, in order to check solutions.</p>
<p>Here is an example of how to implement a propagator for <code>X &gt;= Y</code>:</p>
<pre><code>// Propagator to apply X &gt;= Y
public class MySimplePropagator extends Propagator&lt;IntVar&gt; {

    IntVar x, y;

    public MySimplePropagator(IntVar x, IntVar y) {
        super(new IntVar[]{x,y});
        this.x = x;
        this.y = y;
    }

    @Override
    public void propagate(int evtmask) throws ContradictionException {
        x.updateLowerBound(y.getLB(), this);
        y.updateUpperBound(x.getUB(), this);
    }

    @Override
    public ESat isEntailed() {
        if (x.getUB() &lt; y.getLB())
            return ESat.FALSE;
        else if (x.getLB() &gt;= y.getUB())
            return ESat.TRUE;
        else
            return ESat.UNDEFINED;
    }
}
</code></pre><h4 id="elaborated-propagator">Elaborated propagator</h4>
<p>The super constructor <code>super(Variable[], PropagatorPriority, boolean);</code> brings more information.
<code>PropagatorPriority</code> enables to optimize the propagation engine (low arity for fast propagators is better).
The boolean argument allows to specifies the propagator is incremental.
When set to <code>true</code>, the method <code>propagate(int varIdx, int mask)</code> must be implemented.</p>
<p><strong>NOTE</strong>: Note that if many variables are modified between two calls, a non-incremental filtering may be faster (and simpler).</p>
<p>The method <code>propagate(int varIdx, int mask)</code> defines the incremental filtering.
It is called for every variable <code>vars[varIdx]</code> whose domain has changed since the last call.</p>
<p>The method <code>getPropagationConditions(int vIdx)</code> enables not to react on every kind of domain modification.</p>
<p>The method <code>setPassive()</code> enables to desactivate the propagator when it is entailed, to save time.
The propagator is automatically reactivated upon backtrack.</p>
<p>The method <code>why(...)</code> explains the filtering, to allow learning.</p>
<p>Here is an example of how to implement a propagator for <code>X &gt;= Y</code>:</p>
<pre><code>// Propagator to apply X &gt;= Y
public final class MyIncrementalPropagator extends Propagator&lt;IntVar&gt; {

    IntVar x, y;

    public MyIncrementalPropagator(IntVar x, IntVar y) {
        super(new IntVar[]{x,y}, PropagatorPriority.BINARY, true);
        this.x = x;
        this.y = y;
    }

    @Override
    public int getPropagationConditions(int vIdx) {
        if (vIdx == 0) {
            // awakes if x gets instantiated or if its upper bound decreases
            return IntEventType.combine(IntEventType.INSTANTIATE, IntEventType.DECUPP);
        } else {
            // awakes if y gets instantiated or if its lower bound increases
            return IntEventType.combine(IntEventType.INSTANTIATE, IntEventType.INCLOW);
        }
    }

    @Override
    public void propagate(int evtmask) throws ContradictionException {
        x.updateLowerBound(y.getLB(), this);
        y.updateUpperBound(x.getUB(), this);
        if (x.getLB() &gt;= y.getUB()) {
            this.setPassive();
        }
    }

    @Override
    public void propagate(int varIdx, int mask) throws ContradictionException {
        if (varIdx == 0) {
            y.updateUpperBound(x.getUB(), this);
        } else {
            x.updateLowerBound(y.getLB(), this);
        }
        if (x.getLB() &gt;= y.getUB()) {
            this.setPassive();
        }
    }

    @Override
    public ESat isEntailed() {
        if (x.getUB() &lt; y.getLB())
            return ESat.FALSE;
        else if (x.getLB() &gt;= y.getUB())
            return ESat.TRUE;
        else
            return ESat.UNDEFINED;
    }

    @Override
    public boolean why(RuleStore ruleStore, IntVar var, IEventType evt, int value) {
        boolean newrules = ruleStore.addPropagatorActivationRule(this);
        if (var.equals(x)) {
            newrules |=ruleStore.addLowerBoundRule(y);
        } else if (var.equals(y)) {
            newrules |=ruleStore.addUpperBoundRule(x);
        } else {
            newrules |=super.why(ruleStore, var, evt, value);
        }
        return newrules;
    }

    @Override
    public String toString() {
        return &quot;prop(&quot; + vars[0].getName() + &quot;.GEQ.&quot; + vars[1].getName() + &quot;)&quot;;
    }
}
</code></pre><h3 id="idempotency">Idempotency</h3>
<p>We distinguish two kinds of propagators:</p>
<blockquote>
<p><em>Necessary</em> propagators, which ensure constraints to be satisfied.</p>
</blockquote>
<blockquote>
<p><em>Redundant</em> (or <em>Implied</em>) propagators that come in addition to some necessary propagators in order to get a stronger filtering.</p>
</blockquote>
<p>Some propagators cannot be idempotent (Lagrangian relaxation, use of randomness, etc.).
For some others, forcing idempotency may be very time consuming.
A redundant propagator does not have to be idempotent but <strong>a necessary propagator should be idempotent</strong>  .</p>
<p>Trying to make a propagator idempotent directly may not be straightforward.
We provide three implementation possibilities.</p>
<p>The <em>decomposed</em>  (recommended) option:</p>
<blockquote>
<p>Split the original propagator into (partial) propagators so that the fix point is performed through the propagation engine.
For instance, a channeling propagator $A \Leftrightarrow B$ can be decomposed into two propagators $A \Rightarrow B$ and $B \Rightarrow A$.
The propagators can (but do not have to) react on fine events.</p>
</blockquote>
<p>The <em>lazy</em> option:</p>
<blockquote>
<p>Simply post the propagator twice.
Thus, the fix point is performed through the propagation engine.</p>
</blockquote>
<p>The <em>coarse</em> option:</p>
<blockquote>
<p>the propagator will perform its fix point by itself.
The propagator does not react to fine events.
The coarse filtering algorithm should be surrounded like this:</p>
</blockquote>
<blockquote>
<pre><code>// In the case of ``SetVar``, replace ``getDomSize()`` by ``getEnvSize()-getKerSize()``.
long size;
do{
  size = 0;
  for(IntVar v:vars){
    size+=v.getDomSize();
  }
  // really update domain variables here
  for(IntVar v:vars){
    size-=v.getDomSize();
  }
}while(size&gt;0);
</code></pre></blockquote>
<p><strong>NOTE</strong>: Domain variable modifier returns a boolean valued to <code>true</code> if the domain variable has been modified.</p>

	
		<style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<h2 class="feedback--title">Feedback</h2>
<p class="feedback--question">Was this page helpful?</p>
<button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it! Please <a href="https://github.com/chocoteam/choco-solver/issues/new">tell us how we can improve</a>.
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that. Please <a href="https://github.com/chocoteam/choco-solver/issues/new">tell us how we can improve</a>.
</p>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>

		<br />
	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified 01.01.0001: <a  href="https://github.com/chocoteam/choco-solver/commit/7c55b811d5214e17ba073d2412c9201510992474">Removed submodule (7c55b81)</a>
</div>
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Google group" aria-label="Google group">
    <a class="text-white" target="_blank" href="https://groups.google.com/forum/#!forum/choco-solver">
      <i class="fa fa-comments"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" href="https://stackoverflow.com/questions/tagged/choco">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" href="https://github.com/chocoteam/choco-solver">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" href="https://choco-solver.slack.com/">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Gitter" aria-label="Gitter">
    <a class="text-white" target="_blank" href="https://gitter.im/chocoteam/choco-solver">
      <i class="fab fa-gitter"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2020 The Choco-solver Authors All Rights Reserved</small>
        <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank">Privacy Policy</a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>







<script src="/js/main.min.29b0315468c00226fa6f4556a9cebc0ac4fe1ce1457a01b22c0a06b329877383.js" integrity="sha256-KbAxVGjAAib6b0VWqc68CsT&#43;HOFFegGyLAoGsymHc4M=" crossorigin="anonymous"></script>



  </body>
</html>