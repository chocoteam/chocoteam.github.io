<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Codes &mdash; choco-tuto 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="choco-tuto 1.0.0 documentation" href="../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="codes">
<h1>Codes<a class="headerlink" href="#codes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="model-with-a-global-interpretation">
<h2>Model with a global interpretation<a class="headerlink" href="#model-with-a-global-interpretation" title="Permalink to this headline">¶</a></h2>
<p>The first model is based on the global interpretation of the equation.</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Model</span> <span class="n">model</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Model</span><span class="o">(</span><span class="s">&quot;SEND+MORE=MONEY&quot;</span><span class="o">);</span>
<span class="n">IntVar</span> <span class="n">S</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">intVar</span><span class="o">(</span><span class="s">&quot;S&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">IntVar</span> <span class="n">E</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">intVar</span><span class="o">(</span><span class="s">&quot;E&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">IntVar</span> <span class="n">N</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">intVar</span><span class="o">(</span><span class="s">&quot;N&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">IntVar</span> <span class="n">D</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">intVar</span><span class="o">(</span><span class="s">&quot;D&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">IntVar</span> <span class="n">M</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">intVar</span><span class="o">(</span><span class="s">&quot;M&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">IntVar</span> <span class="n">O</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">intVar</span><span class="o">(</span><span class="s">&quot;0&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">IntVar</span> <span class="n">R</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">intVar</span><span class="o">(</span><span class="s">&quot;R&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">IntVar</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">intVar</span><span class="o">(</span><span class="s">&quot;Y&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>

<span class="n">model</span><span class="o">.</span><span class="na">allDifferent</span><span class="o">(</span><span class="k">new</span> <span class="n">IntVar</span><span class="o">[]{</span><span class="n">S</span><span class="o">,</span> <span class="n">E</span><span class="o">,</span> <span class="n">N</span><span class="o">,</span> <span class="n">D</span><span class="o">,</span> <span class="n">M</span><span class="o">,</span> <span class="n">O</span><span class="o">,</span> <span class="n">R</span><span class="o">,</span> <span class="n">Y</span><span class="o">}).</span><span class="na">post</span><span class="o">();</span>

<span class="n">IntVar</span><span class="o">[]</span> <span class="n">ALL</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntVar</span><span class="o">[]{</span>
    <span class="n">S</span><span class="o">,</span> <span class="n">E</span><span class="o">,</span> <span class="n">N</span><span class="o">,</span> <span class="n">D</span><span class="o">,</span>
    <span class="n">M</span><span class="o">,</span> <span class="n">O</span><span class="o">,</span> <span class="n">R</span><span class="o">,</span> <span class="n">E</span><span class="o">,</span>
    <span class="n">M</span><span class="o">,</span> <span class="n">O</span><span class="o">,</span> <span class="n">N</span><span class="o">,</span> <span class="n">E</span><span class="o">,</span> <span class="n">Y</span><span class="o">};</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">COEFFS</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span>
    <span class="mi">1000</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span>
    <span class="mi">1000</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span>
    <span class="o">-</span><span class="mi">10000</span><span class="o">,</span> <span class="o">-</span><span class="mi">1000</span><span class="o">,</span> <span class="o">-</span><span class="mi">100</span><span class="o">,</span> <span class="o">-</span><span class="mi">10</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">};</span>
<span class="n">model</span><span class="o">.</span><span class="na">scalar</span><span class="o">(</span><span class="n">ALL</span><span class="o">,</span> <span class="n">COEFFS</span><span class="o">,</span> <span class="s">&quot;=&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">).</span><span class="na">post</span><span class="o">();</span>

<span class="n">Solver</span> <span class="n">solver</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">getSolver</span><span class="o">();</span>
<span class="n">solver</span><span class="o">.</span><span class="na">showStatistics</span><span class="o">();</span>
<span class="n">solver</span><span class="o">.</span><span class="na">showSolutions</span><span class="o">();</span>
<span class="n">solver</span><span class="o">.</span><span class="na">findSolution</span><span class="o">();</span>
</pre></div>
</td></tr></table></div>
<p>The solution found is:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">**</span> <span class="n">Choco</span> <span class="mf">3.3</span><span class="o">.</span><span class="mi">3</span> <span class="p">(</span><span class="mi">2015</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span> <span class="p">:</span> <span class="n">Constraint</span> <span class="n">Programming</span> <span class="n">Solver</span><span class="p">,</span> <span class="n">Copyleft</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">2015</span>
<span class="o">-</span> <span class="n">Model</span><span class="p">[</span><span class="n">Model</span><span class="o">-</span><span class="mi">0</span><span class="p">]</span> <span class="n">features</span><span class="p">:</span>
    <span class="n">Variables</span> <span class="p">:</span> <span class="mi">9</span>
    <span class="n">Constraints</span> <span class="p">:</span> <span class="mi">4</span>
    <span class="n">Default</span> <span class="n">search</span> <span class="n">strategy</span> <span class="p">:</span> <span class="n">no</span>
    <span class="n">Completed</span> <span class="n">search</span> <span class="n">strategy</span> <span class="p">:</span> <span class="n">no</span>
<span class="o">-</span> <span class="n">Solution</span> <span class="c1">#1 found. Model[Model-0], 1 Solutions, Resolution time 0,004s, 3 Nodes (742,4 n/s), 1 Backtracks, 1 Fails, 0 Restarts</span>
    <span class="n">S</span> <span class="o">=</span> <span class="mi">9</span> <span class="n">E</span> <span class="o">=</span> <span class="mi">5</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span> <span class="n">D</span> <span class="o">=</span> <span class="mi">7</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1</span> <span class="mi">0</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">8</span> <span class="n">Y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">.</span>
<span class="o">-</span> <span class="n">Complete</span> <span class="n">search</span> <span class="o">-</span> <span class="mi">1</span> <span class="n">solution</span> <span class="n">found</span><span class="o">.</span>
    <span class="n">Model</span><span class="p">[</span><span class="n">Model</span><span class="o">-</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Solutions</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">Building</span> <span class="n">time</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="mi">000</span><span class="n">s</span>
    <span class="n">Resolution</span> <span class="n">time</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="mi">008</span><span class="n">s</span>
    <span class="n">Nodes</span><span class="p">:</span> <span class="mi">3</span> <span class="p">(</span><span class="mi">383</span><span class="p">,</span><span class="mi">5</span> <span class="n">n</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
    <span class="n">Backtracks</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">Fails</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">Restarts</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The <em>alldifferent</em> constraint (line 11) makes sure all letters are distinct.</p>
<p>Then, instead of using expressions, which tend to be too verbose,
we directly declare a scalar product and post it (lines 13-21).
Thus, the expression is not decomposed on posting (no additional variables are introduced) and it ensures a better filtering.
Alternatively, the expression could have been post in extension, providing an even better filtering algorithm, but
at high pre-process time.</p>
<p>Finally, we rely on the capacity of the solver to output data on console (lines 24-25).
Basic search statistics (time, nodes, etc) are reported but also a pre-defined solution format:
each variable&#8217;s name is followed a &#8220;=&#8221; sign and the value of the variable in the solution.
This avoids getting a solution object and reads it.</p>
<p>Another alternative would be to call <code class="code docutils literal"><span class="pre">solver.solve()</span></code> which looks for the first solution (if any) and stops <em>on it</em>,
that is, on a state wherein each variable is assigned to a single value.
Their value can then be read calling <code class="code docutils literal"><span class="pre">S.getValue()</span></code>:</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="na">getSolver</span><span class="o">().</span><span class="na">showStatistics</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">model</span><span class="o">.</span><span class="na">getSolver</span><span class="o">().</span><span class="na">solve</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;%s = %d\n&quot;</span><span class="o">,</span> <span class="n">S</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">S</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&quot;%s = %d\n&quot;</span><span class="o">,</span> <span class="n">E</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">E</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Simply replace the <cite>if</cite> by a <cite>while</cite> to look for all solutions and print them all.
However, this problem has only one solution.</p>
</div>
</div>
<div class="section" id="model-with-a-local-interpretation">
<h2>Model with a local interpretation<a class="headerlink" href="#model-with-a-local-interpretation" title="Permalink to this headline">¶</a></h2>
<p>The second model requires to introduces 3 additional variables.</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// additional variables: the carries</span>
<span class="n">BoolVar</span><span class="o">[]</span> <span class="n">r</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">boolVarArray</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
<span class="c1">// declare local equations</span>
<span class="n">D</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">E</span><span class="o">).</span><span class="na">eq</span><span class="o">(</span><span class="n">Y</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">r</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">mul</span><span class="o">(</span><span class="mi">10</span><span class="o">))).</span><span class="na">post</span><span class="o">();</span>
<span class="n">r</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">add</span><span class="o">(</span><span class="n">N</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="n">R</span><span class="o">).</span><span class="na">eq</span><span class="o">(</span><span class="n">E</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">r</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">mul</span><span class="o">(</span><span class="mi">10</span><span class="o">))).</span><span class="na">post</span><span class="o">();</span>
<span class="n">r</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">add</span><span class="o">(</span><span class="n">E</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="n">O</span><span class="o">).</span><span class="na">eq</span><span class="o">(</span><span class="n">N</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">r</span><span class="o">[</span><span class="mi">2</span><span class="o">].</span><span class="na">mul</span><span class="o">(</span><span class="mi">10</span><span class="o">))).</span><span class="na">post</span><span class="o">();</span>
<span class="n">r</span><span class="o">[</span><span class="mi">2</span><span class="o">].</span><span class="na">add</span><span class="o">(</span><span class="n">S</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="n">M</span><span class="o">).</span><span class="na">eq</span><span class="o">(</span><span class="n">O</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">M</span><span class="o">.</span><span class="na">mul</span><span class="o">(</span><span class="mi">10</span><span class="o">))).</span><span class="na">post</span><span class="o">();</span>
</pre></div>
</td></tr></table></div>
<p>Doing so, we increase the number of variables and constraints and introduce some search noise.
Indeed, without indication on how to explore the search, the solver will consider all variables
as decisions ones, that is as search leader.
But, we may want only to branch on letters and ignoring other ones (basically, the carries
which are assigned by propagation.</p>
<p>To do so, we can precise the <em>decision variables</em> and how to branch on it:</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">solver</span><span class="o">.</span><span class="na">set</span><span class="o">(</span>
    <span class="n">SearchStrategyFactory</span><span class="o">.</span><span class="na">inputOrderLBSearch</span><span class="o">(</span><span class="n">S</span><span class="o">,</span> <span class="n">E</span><span class="o">,</span> <span class="n">N</span><span class="o">,</span> <span class="n">D</span><span class="o">,</span> <span class="n">M</span><span class="o">,</span> <span class="n">O</span><span class="o">,</span> <span class="n">R</span><span class="o">,</span> <span class="n">Y</span><span class="o">));</span>
</pre></div>
</td></tr></table></div>
<p>Here, we consider the variables in the input order (S is selected first, then E, then N, ...)
and each of them are, in turn, assigned to their current lower bound.</p>
</div>
<div class="section" id="things-to-remember">
<h2>Things to remember<a class="headerlink" href="#things-to-remember" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>There exists multiple ways to declare expressions. Specific ones, like sum or scalar product, should be considered when modeling a problem.</li>
<li>Extension constraints provide a powerful filtering algorithm but may come at a high pre-process time.</li>
<li>The <cite>Solver</cite> enables having access to a solution by calling the <cite>solve()</cite> method. This is also an easy way to loop over all solutions.</li>
<li>Defining a (dedicated) search strategy is a good habit to help the solver exploring the search space.</li>
</ul>
<p><a class="reference external" href="302.mathmodel.html">&lt;&lt;mathematical model</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">choco-tuto</a></h1>





<p>
<iframe src="https://ghbtns.com/github-btn.html?user=&repo=&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>




<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="001.introduction.html">Introduction to choco-tuto</a></li>
<li class="toctree-l1"><a class="reference internal" href="002.history.html">Choco, a constraint programming java library</a></li>
<li class="toctree-l1"><a class="reference internal" href="003.installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="201.firstexample.html">A first example</a></li>
<li class="toctree-l1"><a class="reference internal" href="202.objects.html">Objects in Choco</a></li>
<li class="toctree-l1"><a class="reference internal" href="203.firstexample2.html">Playing around with 8-queens puzzle</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="301.description.html">Verbal arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="401.description.html">Warehouse Location Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="501.description.html">Aircraft Landing Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="601.description.html">Nonogram</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Charles Prud'homme.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../_sources/src/303.code.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>